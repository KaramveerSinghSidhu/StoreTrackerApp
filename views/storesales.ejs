<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <title>StoreTracker | 5501</title>
</head>
<style>
    body{
        background: rgba(250, 220, 0, 1);
    }
</style>
<body class="">
    <div>
    <div class="row">
        <h1 class="col m-5">Store 5501</h1>
        <div class="p-5 col text-end">
            <div class="row">
                <div class="col"></div>
                <div class="col"></div>
                <div class="col"></div>
                <div class="col"></div>
                <h6 class="col pt-2"><%= username.name%></h6>
                <a class="col btn btn-dark" href="/logout">Sign out</a>
            </div>
        </div>
    </div>
    <div class="container">
        <nav>
            <ul class="row bg-dark">
                <li class="d-inline col"><a class="btn ps-4 p-3 pe-4 me-5 ms-5 col btn-dark" href="/home">New Sale</a></li>
                <li class="d-inline col"><a class="btn ps-4 p-3 pe-4 me-5 ms-5 col btn-dark" href="/sales">Rep Sales</a></li>
                <li class="d-inline col"><a class="btn ps-4 p-3 pe-4 me-5 ms-5 col btn-dark" href="/store">Store Sales</a></li>
                <li class="d-inline col"><a class="btn ps-4 p-3 pe-4 me-5 ms-5 col btn-dark" href="/returns">Returns</a></li>
                <li class="d-inline col"><a class="btn ps-4 p-3 pe-4 me-5 ms-5 col btn-dark" href="/promos">Promos</a></li>
            </ul>
        </nav>
    </div>
</div>
<div class="container">
    <h3 class="col m-5 text-center">Store Weekly Sales</h3>

    <div class="container row mt-4 mb-4 bg-dark p-2 ms-1">
        <% if (week - 1 == 0){ %>
            <div class="col"><a class="btn-secondary me-2 btn" onClick="weekCheck()" href="/store/<%= year - 1 %>/<%=52%>">Last Week</a></div>
            <% } else { %>
        <div class="col ms-4"><a class="btn-secondary btn" onClick="weekCheck()" href="/store/<%= year %>/<%=week - 1%>">Last Week</a></div>
        <%}%>
        <div class="col"></div>
        <div class="col"></div>
        <div class="col"></div>
        <% if(username.role == "Management") { %>
            <div class="col"> <a class="btn btn-primary" href="/store/manage">Management</a></div>
            <%}%>
        <div class="col"></div>
        <div class="col"></div>
        <div class="col"></div>
        <% if (week + 1 > 52){ %>
            <div class="col"><a class="btn-secondary me-2 btn" onClick="weekCheck()" href="/store/<%= year + 1 %>/<%=1%>">Next Week</a></div>
            <% } else { %>
            <div class="col"><a class="btn-secondary me-2 btn" onClick="weekCheck()"href="/store/<%= year %>/<%=week + 1%>">Next Week</a></div>
            <%}%>
    </div>
    <div class="row ps-3 pt-3 pe-3 pb-1 text-center bg-secondary">
        <h6 class="col">Week: <%=week%></h6>
        <h6 class="col">ID</h6>
        <h6 class="col">Total Subs</h6>
        <h6 class="col">Accessories</h6>
        <h6 class="col">Term Subs</h6>
        <h6 class="col">FDP</h6>
        <h6 class="col">ARS</h6>
        <h6 class="col">FDP%</h6>
        <h6 class="col">Subs to Target</h6>
        <h6 class="col">Color</h6>
        <h6 class="col">Detail</h6>
    </div>
    <% thisWeek.forEach(sale => { %>
    <div class="bg-light mt-4">
        <div>
            <div class="row ps-3 pt-3 pe-3 pb-1 text-center bg-light">
                <h6 class="col"><%= sale.user %></h6>
                <h6 class="col"><%= sale.userID %></h6>
                <h6 class="col"><%= sale.totalSubs %></h6>
                <h6 class="col">$<%= sale.acc %></h6>
                <h6 class="col"><%= sale.termSubs %></h6>
                <h6 class="col"><%= sale.fdp %></h6>
                <h6 class="col">$<%= sale.ars %></h6>
                <h6 class="col"><%= sale.fdpAttach %>%</h6>
                <h6 class="col">
                    <% if(sale.totalSubs > sale.strech) { %>
                            0
                        <% }else if(sale.totalSubs < sale.target){ %>
                            <%= sale.target - sale.totalSubs %>
                        <% } else if(sale.totalSubs >= sale.target){ %>
                            <%= sale.strech - sale.totalSubs  %>
                        <% } %>
                </h6>
                <h6 class="col">
                    <% if(sale.weeklyAchieved == "Green") { %>
                            <a class="btn btn-success btn-lg active rounded-circle pt-3 pb-3 mt-1"></a>
                        <% }else if(sale.weeklyAchieved == "Yellow"){ %>
                            <a class="btn btn-warning btn-lg active rounded-circle pt-3 pb-3 mt-1"></a>
                        <% }else{ %>
                            <a class="btn btn-danger btn-lg active rounded-circle pt-3 pb-3 mt-1"></a>
                        <% } %>
                </h6>
                <a class="btn-dark mb-2 btn col" href="/weekly/<%= sale.userID%>/<%= sale.year %>/<%= sale.week %>">View</a>
            </div>
        </div>
    </div>
    <% }) %>
    <div class="row ps-3 pt-3 pe-3 pb-3 mt-4 mb-5 text-center bg-secondary">
        <h6 class="col mt-2">Week End:</h6>
        <h6 class="col mt-2"><%= storeWeekly.endOfWeek %></h6>
        <h6 class="col mt-2"><%= storeWeekly.totalSubs %></h6>
        <h6 class="col mt-2">$<%= storeWeekly.acc %></h6>
        <h6 class="col mt-2"><%= storeWeekly.termSubs %></h6>
        <h6 class="col mt-2"><%= storeWeekly.fdp %></h6>
        <h6 class="col mt-2">$<%= storeWeekly.ars %></h6>
        <h6 class="col mt-2"><%= storeWeekly.fdpAttach %>%</h6>
        <h6 class="col mt-2">
            <% if(storeWeekly.totalSubs > storeWeekly.strech) { %>
                    0
                <% }else if(storeWeekly.totalSubs < storeWeekly.target){ %>
                    <%= storeWeekly.target - storeWeekly.totalSubs %>
                <% } else if(storeWeekly.totalSubs >= storeWeekly.target){ %>
                    <%= storeWeekly.strech - storeWeekly.totalSubs  %>
                <% } %>
        </h6>
        <h6 class="col">
            <% if(storeWeekly.weeklyAchieved == "Green") { %>
                <a class="btn btn-success btn-lg active rounded-circle pt-3 pb-3 mt-1"></a>
                <% }else if(storeWeekly.weeklyAchieved == "Yellow"){ %>
                <a class="btn btn-warning btn-lg active rounded-circle pt-3 pb-3 mt-1"></a>
                <% }else{ %>
                <a class="btn btn-danger btn-lg active rounded-circle pt-3 pb-3 mt-1"></a>
                <% } %>
            </h6>
        <h6 class="col mt-2">Week: <%= storeWeekly.week %></h6>
    </div>
</div>
</body>
</html>